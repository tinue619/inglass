<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM System - –û–û–ü –≤–µ—Ä—Å–∏—è</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/drag-drop.css">
</head>
<body>
    <div id="app"></div>
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –û–û–ü –º–æ–¥—É–ª–µ–π -->
    <script>
        console.log('üîß –ó–∞–≥—Ä—É–∑–∫–∞ –û–û–ü –º–æ–¥—É–ª–µ–π CRM —Å–∏—Å—Ç–µ–º—ã...');
    </script>
    
    <!-- –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã -->
    <script src="js/classes/BaseEntity.js"></script>
    <script src="js/classes/Phone.js"></script>
    <script src="js/classes/User.js"></script>
    <script src="js/classes/Process.js"></script>
    <script src="js/classes/Product.js"></script>
    <script src="js/classes/OrderHistoryEvent.js"></script>
    <script src="js/classes/DefectInfo.js"></script>
    <script src="js/classes/Order.js"></script>
    
    <!-- –°–µ—Ä–≤–∏—Å—ã -->
    <script src="js/services/StorageService.js"></script>
    <script src="js/services/DataRepository.js"></script>
    <script src="js/services/AuthService.js"></script>
    <script src="js/services/OrderService.js"></script>
    
    <!-- –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <script src="js/services/CRMApplication.js"></script>
    
    <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è -->
    <script>
        console.log('‚úÖ –í—Å–µ –û–û–ü –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log('üéØ –ó–∞–ø—É—Å–∫ –û–û–ü CRM —Å–∏—Å—Ç–µ–º—ã...');
                await window.app.init();
                
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                const stats = window.app.dataRepository.getStatistics();
                if (stats.processes === 0) {
                    console.log('üìù –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ...');
                    window.app.dataRepository.createTestData();
                    window.app.dataRepository.save();
                }
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
                document.getElementById('app').innerHTML = `
                    <div style="padding: 20px; color: red; text-align: center;">
                        <h2>‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞</h2>
                        <p>${error.message}</p>
                        <button onclick="location.reload()" class="btn btn-primary">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
